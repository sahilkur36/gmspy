
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "sphinx_gallery_examples\01preprocessing\plot_01_baseline_correction.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_sphinx_gallery_examples_01preprocessing_plot_01_baseline_correction.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_sphinx_gallery_examples_01preprocessing_plot_01_baseline_correction.py:


.. _ref_ex_baseline:

Baseline Correction
---------------------

Baseline Correction, like in SeismoSignal, consists in (i) determining, through regression analysis
(least-squares-fit method), the polynomial curve that best fits the time-acceleration pairs
of values and then (ii) subtracting from the actual acceleration values their corresponding counterparts
as obtained with the regression-derived equation.
In this manner, spurious baseline trends, usually well noticeable in the displacement time-history
obtained from double time-integration of uncorrected acceleration records,
are removed from the input motion.

see :func:`gmspy.baselinecorr`.

.. GENERATED FROM PYTHON SOURCE LINES 17-24

.. code-block:: Python


    import numpy as np
    import matplotlib.pyplot as plt
    from scipy.integrate import cumulative_trapezoid

    import gmspy as gm








.. GENERATED FROM PYTHON SOURCE LINES 25-26

load "kobe" records

.. GENERATED FROM PYTHON SOURCE LINES 26-29

.. code-block:: Python

    ts, acc = gm.load_gm_examples('Kobe')
    dt = ts[1] - ts[0]








.. GENERATED FROM PYTHON SOURCE LINES 30-31

Obtain uncorrected velocity and displacement sequences by direct integration

.. GENERATED FROM PYTHON SOURCE LINES 31-35

.. code-block:: Python

    vel = cumulative_trapezoid(acc, ts, initial=0)
    disp = cumulative_trapezoid(vel, ts, initial=0)
    plot_obj_ori = [acc, vel, disp]








.. GENERATED FROM PYTHON SOURCE LINES 36-37

Obtain corrected time histories by different polynomial degrees

.. GENERATED FROM PYTHON SOURCE LINES 37-48

.. code-block:: Python

    plot_obj_corr = []
    degrees = [0, 1, 2, 3]
    for i, degree in enumerate(degrees):
        acc_corr, vel_corr, disp_corr = gm.baselinecorr(ts,
                                                        acc,
                                                        degree,
                                                        plot=False)
        plot_obj_corr.append([acc_corr, vel_corr, disp_corr])
    colors = ['#037ef3', '#f85a40', '#00c16e', '#7552cc']
    titles = ['acceleration', 'velocity', 'displacement']








.. GENERATED FROM PYTHON SOURCE LINES 49-50

plot figure

.. GENERATED FROM PYTHON SOURCE LINES 50-68

.. code-block:: Python

    fig, axs = plt.subplots(3, 1, figsize=(9, 12), sharex=True)
    for j in range(3):
        ax = axs[j]
        ax.plot(ts, plot_obj_ori[j], c='gray', lw=1, alpha=0.6, label="origin")
        for k, degree in enumerate(degrees):
            ax.plot(ts,
                    plot_obj_corr[k][j],
                    c=colors[k],
                    lw=1,
                    label=f"degree={degree}")
        ax.hlines(0, np.min(ts), np.max(ts), lw=0.5, colors='k')
        ax.set_xlim(np.min(ts), np.max(ts))
        ax.grid(False)
        ax.set_ylabel(titles[j], fontsize=15)
        ax.tick_params(labelsize=12)
    axs[0].legend(fontsize=12, ncol=5, loc='center', bbox_to_anchor=(0.5, 1.15))
    axs[-1].set_xlabel("Time (s)", fontsize=15)
    plt.show()



.. image-sg:: /sphinx_gallery_examples/01preprocessing/images/sphx_glr_plot_01_baseline_correction_001.png
   :alt: plot 01 baseline correction
   :srcset: /sphinx_gallery_examples/01preprocessing/images/sphx_glr_plot_01_baseline_correction_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.676 seconds)


.. _sphx_glr_download_sphinx_gallery_examples_01preprocessing_plot_01_baseline_correction.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_01_baseline_correction.ipynb <plot_01_baseline_correction.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_01_baseline_correction.py <plot_01_baseline_correction.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
